#!/usr/bin/env ruby

require "erb"
require "fileutils"
require "ostruct"

case ARGV.first
  when "model"
    name = ARGV[1] || abort("Missing model name")
    class_name = name.capitalize
    file_name  = name.downcase
    template = ERB.new(File.read("./vendor/pliny/templates/model.erb"))
    FileUtils.mkdir_p "./lib/models"
    File.open("./lib/models/#{file_name}.rb", "w") do |f|
      vars = OpenStruct.new(class_name: class_name)
      f.puts template.result(vars.instance_eval { binding })
    end
  else
    abort("Don't know how to generate #{ARGV.first}")
end
